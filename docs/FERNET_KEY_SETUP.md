# Fernet Key Setup - Виправлення помилки шифрування

## Проблема

Якщо ви бачите помилку:
```
Fernet key must be 32 url-safe base64-encoded bytes.
```

Це означає, що потрібно додати правильний `FERNET_KEY` в `.env` файл.

## Рішення

### Крок 1: Згенеруйте ключ

Запустіть скрипт для генерації ключа:

```bash
python backend/generate_fernet_key.py
```

Ви побачите щось таке:
```
============================================================
Generated Fernet Key:
============================================================
xV8dC3EuH1qY9Zw7kR5mN2pL4tJ6aS8fG0bV1nM3cQ4=
============================================================

Add this to your .env file:
FERNET_KEY=xV8dC3EuH1qY9Zw7kR5mN2pL4tJ6aS8fG0bV1nM3cQ4=
============================================================
```

### Крок 2: Додайте ключ в .env

Відкрийте файл `.env` (в корені проекту) і додайте:

```bash
FERNET_KEY=xV8dC3EuH1qY9Zw7kR5mN2pL4tJ6aS8fG0bV1nM3cQ4=
```

**Важливо:** Використовуйте **ВАШ** згенерований ключ, а не приклад вище!

### Крок 3: Перезапустіть сервіси

**Docker:**
```bash
docker-compose restart backend
```

**Або без Docker:**
```bash
# Зупиніть сервер і запустіть знову
python manage.py runserver
```

## Для чого використовується?

`FERNET_KEY` використовується для **шифрування** конфіденційних даних:
- Telegram bot tokens
- WhatsApp API credentials
- Google Calendar tokens
- Інші API ключі інтеграцій

## Безпека

⚠️ **НІКОЛИ** не додавайте `FERNET_KEY` в Git!

- `.env` файл має бути в `.gitignore`
- Кожне середовище (dev, production) має свій унікальний ключ
- Якщо ключ втратили - старі зашифровані дані не можна розшифрувати

## Додаткова інформація

### Що таке Fernet?

Fernet - це симетричне шифрування від бібліотеки `cryptography`.
Використовує AES-128 в режимі CBC з HMAC-SHA256 для автентифікації.

### Чому не використовувати SECRET_KEY?

- `SECRET_KEY` - для Django сесій, CSRF, підписів
- `FERNET_KEY` - спеціально для шифрування даних
- Розділення ключів = краща безпека
